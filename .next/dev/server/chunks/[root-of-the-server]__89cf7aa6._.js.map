{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/eol-prime-sandbox/src/lib/mongo.ts"],"sourcesContent":["// src/lib/mongo.ts — FINAL\r\nimport { MongoClient } from \"mongodb\";\r\n\r\nconst uri = process.env.MONGODB_URI;\r\n\r\nlet clientPromise: Promise<MongoClient>;\r\n\r\nif (!uri) {\r\n  console.log(\"MONGODB_URI not set — DEMO MODE\");\r\n  const mockDb = {\r\n    collection: () => ({\r\n      findOne: async () => null,\r\n      insertOne: async () => ({ insertedId: \"mock-id\" }),\r\n      updateOne: async () => ({ modifiedCount: 1 }),\r\n      deleteOne: async () => ({ deletedCount: 0 }),\r\n      bulkWrite: async () => ({ modifiedCount: 0 }),\r\n      find: () => ({\r\n        sort: () => ({\r\n          limit: () => ({\r\n            toArray: async () => [],\r\n          }),\r\n        }),\r\n      }),\r\n    }),\r\n    command: async () => ({ ok: 1 }),\r\n  };\r\n  const mockClient = { db: () => mockDb } as unknown as MongoClient;\r\n  clientPromise = Promise.resolve(mockClient);\r\n} else {\r\n  const client = new MongoClient(uri);\r\n  clientPromise = client.connect();\r\n}\r\n\r\nexport { clientPromise };\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;AAC3B;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AAEnC,IAAI;AAEJ,IAAI,CAAC,KAAK;IACR,QAAQ,GAAG,CAAC;IACZ,MAAM,SAAS;QACb,YAAY,IAAM,CAAC;gBACjB,SAAS,UAAY;gBACrB,WAAW,UAAY,CAAC;wBAAE,YAAY;oBAAU,CAAC;gBACjD,WAAW,UAAY,CAAC;wBAAE,eAAe;oBAAE,CAAC;gBAC5C,WAAW,UAAY,CAAC;wBAAE,cAAc;oBAAE,CAAC;gBAC3C,WAAW,UAAY,CAAC;wBAAE,eAAe;oBAAE,CAAC;gBAC5C,MAAM,IAAM,CAAC;wBACX,MAAM,IAAM,CAAC;gCACX,OAAO,IAAM,CAAC;wCACZ,SAAS,UAAY,EAAE;oCACzB,CAAC;4BACH,CAAC;oBACH,CAAC;YACH,CAAC;QACD,SAAS,UAAY,CAAC;gBAAE,IAAI;YAAE,CAAC;IACjC;IACA,MAAM,aAAa;QAAE,IAAI,IAAM;IAAO;IACtC,gBAAgB,QAAQ,OAAO,CAAC;AAClC,OAAO;IACL,MAAM,SAAS,IAAI,sHAAW,CAAC;IAC/B,gBAAgB,OAAO,OAAO;AAChC","debugId":null}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/eol-prime-sandbox/src/lib/authOptions.ts"],"sourcesContent":["// src/lib/authOptions.ts\r\nimport NextAuth, { type AuthOptions } from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\nimport EmailProvider from \"next-auth/providers/email\";\r\nimport { MongoDBAdapter } from \"@next-auth/mongodb-adapter\";\r\nimport { clientPromise } from \"@/lib/mongo\";\r\n\r\nconst isDev = process.env.NODE_ENV === \"development\";\r\nconst hasSMTP = !!process.env.EMAIL_SERVER;\r\n\r\nexport const authOptions: AuthOptions = {\r\n  adapter: MongoDBAdapter(clientPromise),\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: \"Credentials\",\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"email\" },\r\n        password: { label: \"Password\", type: \"password\" },\r\n      },\r\n      async authorize(credentials) {\r\n        if (!process.env.MONGODB_URI) {\r\n          if (credentials?.email) {\r\n            return { id: \"demo\", name: \"Demo User\", email: credentials.email };\r\n          }\r\n          return null;\r\n        }\r\n        return null;\r\n      },\r\n    }),\r\n    ...(hasSMTP\r\n      ? [\r\n          EmailProvider({\r\n            server: process.env.EMAIL_SERVER,\r\n            from: process.env.EMAIL_FROM,\r\n          }),\r\n        ]\r\n      : []),\r\n  ],\r\n  pages: {\r\n    signIn: \"/signin\",\r\n    error: \"/signin\",\r\n  },\r\n  session: {\r\n    strategy: \"jwt\" as const, // ← EXPLICIT\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n};\r\n\r\nexport default NextAuth(authOptions);\r\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;;;AACzB;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM,QAAQ,oDAAyB;AACvC,MAAM,UAAU,CAAC,CAAC,QAAQ,GAAG,CAAC,YAAY;AAEnC,MAAM,cAA2B;IACtC,SAAS,IAAA,yLAAc,EAAC,sIAAa;IACrC,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;oBAC5B,IAAI,aAAa,OAAO;wBACtB,OAAO;4BAAE,IAAI;4BAAQ,MAAM;4BAAa,OAAO,YAAY,KAAK;wBAAC;oBACnE;oBACA,OAAO;gBACT;gBACA,OAAO;YACT;QACF;WACI,UACA;YACE,IAAA,+JAAa,EAAC;gBACZ,QAAQ,QAAQ,GAAG,CAAC,YAAY;gBAChC,MAAM,QAAQ,GAAG,CAAC,UAAU;YAC9B;SACD,GACD,EAAE;KACP;IACD,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,SAAS;QACP,UAAU;IACZ;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC;uCAEe,IAAA,kJAAQ,EAAC","debugId":null}},
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/eol-prime-sandbox/src/app/api/pulse/route.ts"],"sourcesContent":["// src/app/api/pulse/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/lib/authOptions\";\r\nimport { clientPromise } from \"@/lib/mongo\";\r\n\r\nexport const runtime = \"nodejs\";\r\nexport const dynamic = \"force-dynamic\";\r\n\r\nexport async function GET() {\r\n  const session = await getServerSession(authOptions);\r\n\r\n  // ALLOW DEMO MODE\r\n  if (!session?.user) {\r\n    return NextResponse.json({\r\n      health: \"online\",\r\n      insight: { mood: \"demo\", clarity_score: 3 },\r\n      pulse: 50,\r\n    });\r\n  }\r\n\r\n  try {\r\n    const client = await clientPromise;\r\n    const db = client.db(\"eol_prime_dev\");\r\n\r\n    const entries = await db\r\n      .collection(\"journal_entries\")\r\n      .find({ userId: session.user.id })\r\n      .sort({ date: -1 })\r\n      .limit(5)\r\n      .toArray();\r\n\r\n    const insight =\r\n      entries.length > 0\r\n        ? { mood: \"focused\", clarity_score: 8 }\r\n        : { mood: \"neutral\", clarity_score: 5 };\r\n\r\n    return NextResponse.json({\r\n      health: \"online\",\r\n      insight,\r\n      pulse: Math.sin(Date.now() / 10000) * 30 + 70,\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Pulse API error:\", error);\r\n    return NextResponse.json(\r\n      { error: \"Internal Server Error\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;;;;AAC7B;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAChB,MAAM,UAAU;AAEhB,eAAe;IACpB,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,0IAAW;IAElD,kBAAkB;IAClB,IAAI,CAAC,SAAS,MAAM;QAClB,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,QAAQ;YACR,SAAS;gBAAE,MAAM;gBAAQ,eAAe;YAAE;YAC1C,OAAO;QACT;IACF;IAEA,IAAI;QACF,MAAM,SAAS,MAAM,sIAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,MAAM,UAAU,MAAM,GACnB,UAAU,CAAC,mBACX,IAAI,CAAC;YAAE,QAAQ,QAAQ,IAAI,CAAC,EAAE;QAAC,GAC/B,IAAI,CAAC;YAAE,MAAM,CAAC;QAAE,GAChB,KAAK,CAAC,GACN,OAAO;QAEV,MAAM,UACJ,QAAQ,MAAM,GAAG,IACb;YAAE,MAAM;YAAW,eAAe;QAAE,IACpC;YAAE,MAAM;YAAW,eAAe;QAAE;QAE1C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,QAAQ;YACR;YACA,OAAO,KAAK,GAAG,CAAC,KAAK,GAAG,KAAK,SAAS,KAAK;QAC7C;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}